
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="310b535d-3138-5273-9308-d4dc2de44341")}catch(e){}}();
export const __webpack_esm_id__=123;export const __webpack_esm_ids__=[123];export const __webpack_esm_modules__={5123(e,i,s){s.d(i,{WooCommerceShippingSettings:()=>Ie});var r=s(4683),n=s(7723),t=s(8468),o=s(7143),a=s(3582),d=s(692),l=s(4573),c=s(8804),m=s(5075),p=s(450),h=s(5524),u=s(8931),g=s(4330),x=s(4810),_=s(7432),A=s(3760),y=s(9174),j=s(2936);const f=e=>e.id,w=({item:e})=>e.company||`${e.first_name} ${e.last_name}`,b=({item:e})=>`${e.address_1}, ${e.city}, ${e.state}, ${e.postcode}, ${e.country}`;var v=s(2784);const C={name:"address",kind:"root",baseURL:"/wcshipping/v2/addresses",label:(0,n.__)("Address","woocommerce-shipping"),plural:(0,n.__)("Addresses","woocommerce-shipping"),key:"id",supportsPagination:!1},S=[];var k=s(6087),E=s.n(k);(()=>{if(S.includes(C.name))return;const{addEntities:e}=(0,o.dispatch)(a.store);e([C]),S.push(C.name)})();var I=s(342),N=s(6846),D=s(1609),V=s(1894),B=s(1938),F=s(8629),T=s(136),z=s(3398),P=s(7707),O=s(8846),L=s(5913),R=s(9388),H=s(7500),M=s(5264),Y=s(790);const W=(0,t.createContext)(),q=({children:e,initialValue:i})=>(0,Y.jsx)(W.Provider,{value:i,children:e});var U=s(6062),$=s(3258),G=s(435),Z=s(3487);class J extends D.Component{constructor(e){super(e),this.state={hasError:!1,error:null,componentStack:null,eventId:""}}static getDerivedStateFromError(e){var i,s;return{hasError:!0,error:`${e?.toString()} \nFile name: ${null!==(i=e?.fileName)&&void 0!==i?i:"No fileName reported"} \nStack trace: ${null!==(s=e?.stack)&&void 0!==s?s:"No stack trace reported"}`}}componentDidCatch(e,i){console.warn("logging",{error:e,componentStack:i}),U.v4((()=>{const s=$.Cp(e,{captureContext:{contexts:{react:{componentStack:i}}}});this.setState({eventId:s,componentStack:i})}))}render(){const{onError:e,children:i}=this.props,{hasError:s,error:r}=this.state;return s?e?e(this.state):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)("h4",{children:(0,t.createInterpolateElement)((0,n.__)("The component <mark/> encountered an error","woocommerce-shipping"),{mark:(0,Y.jsx)("mark",{children:D.Children.map(i,(e=>(0,N.Hi)(e)))?.join(", ")})})}),(0,Y.jsx)("p",{children:(0,t.createInterpolateElement)((0,n.__)("Please report the following error by <feedbackform>submitting a crash report</feedbackform> or contacting <a>WooCommerce Shipping Support</a>","woocommerce-shipping"),{feedbackform:(0,Y.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),G.mn({eventId:this.state.eventId})},children:(0,n.__)("submitting a crash report","woocommerce-shipping")}),a:(0,Y.jsx)(Z.A,{href:"https://woocommerce.com/products/shipping/",children:(0,n.__)("WooCommerce Shipping Support","woocommerce-shipping")})})}),(0,Y.jsx)("code",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",overflowX:"auto"},children:r})]}):this.props.children}}D.Component;const K=(e,i)=>s=>(s&&(e.displayName=s),function(s){return(0,Y.jsx)(J,{...i,children:(0,Y.jsx)(e,{...s})})});var X=s(9523);const Q=K((({group:e,errorCallback:i,originCountry:s})=>{const{isUpdating:r,validationErrors:o}=(0,t.useContext)(W),{values:a,getInputProps:d,getCheckboxControlProps:l,getSelectControlProps:c,errors:m}=(0,O.useFormContext)(),p=(0,N.zb)(e,a.country),h=a.country?(0,N.Y5)(a.country):[],u=(e,i)=>{var s,r;return null!=i||(i=d(e)),(null!==(s=o[e])&&void 0!==s?s:m[e])?{...i,help:null!==(r=o[e])&&void 0!==r?r:m[e],className:"has-error"}:i};(0,t.useEffect)((()=>{"general"in o&&i(o.general)}),[i,o]);const g=(0,N.eI)({type:e,originCountry:s,destinationCountry:a.country});return(0,Y.jsx)("div",{children:(0,Y.jsxs)(B.A,{direction:"column",children:[(0,Y.jsx)(L.A,{...u("name"),label:(0,n.__)("Name","woocommerce-shipping"),required:!a.company||a.name,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,Y.jsx)(F.A,{marginTop:0,marginBottom:1}),(0,Y.jsx)(L.A,{...u("company"),label:(0,n.__)("Company","woocommerce-shipping"),required:!a.name,disabled:r,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,Y.jsx)(F.A,{marginTop:0,marginBottom:1}),(0,Y.jsx)(T.A,{children:(0,Y.jsxs)(B.A,{children:[(0,Y.jsx)(R.A,{children:(0,Y.jsx)(L.A,{...u("email"),label:(X.Ld.ORIGIN,(0,n.__)("Email address","woocommerce-shipping")),disabled:r,required:g,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})}),(0,Y.jsx)(R.A,{children:(0,Y.jsx)(L.A,{...u("phone"),label:(X.Ld.ORIGIN,(0,n.__)("Phone","woocommerce-shipping")),placeholder:(0,n.__)("e.g., +1 (212) 555-0123 or 2125550123","woocommerce-shipping"),disabled:r,required:g,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})})]})}),(0,Y.jsx)(F.A,{marginTop:0,marginBottom:1}),(0,Y.jsx)(H.A,{label:(0,n.__)("Country","woocommerce-shipping"),options:p,...u("country",c("country")),disabled:r||!1,required:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,Y.jsx)(F.A,{marginTop:0,marginBottom:1}),(0,Y.jsx)(L.A,{label:(0,n.__)("Address","woocommerce-shipping"),...u("address"),disabled:r,required:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,Y.jsx)(F.A,{marginTop:0,marginBottom:1}),(0,Y.jsx)(L.A,{label:(0,n.__)("City","woocommerce-shipping"),...u("city"),disabled:r,required:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,Y.jsx)(F.A,{marginTop:0,marginBottom:1}),(0,Y.jsxs)(T.A,{direction:"column",children:[(0,Y.jsxs)(B.A,{children:[(0,Y.jsx)(R.A,{children:(0,Y.jsx)(L.A,{label:(0,n.__)("State","woocommerce-shipping"),...u("state",c("state")),disabled:r,required:h.length>0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})}),(0,Y.jsx)(R.A,{children:(0,Y.jsx)(L.A,{label:(0,n.__)("Postal code","woocommerce-shipping"),...u("postcode"),disabled:r,required:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})})]}),e===X.Ld.ORIGIN&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(B.A,{children:(0,Y.jsx)(R.A,{children:(0,Y.jsx)(M.A,{label:(0,n.__)("Save as default origin address","woocommerce-shipping"),disabled:r,...u("defaultAddress",l("defaultAddress")),__nextHasNoMarginBottom:!0})})}),(0,Y.jsx)(B.A,{children:(0,Y.jsx)(R.A,{children:(0,Y.jsx)(M.A,{label:(0,n.__)("Save as default return address","woocommerce-shipping"),disabled:r,...u("defaultReturnAddress",l("defaultReturnAddress")),__nextHasNoMarginBottom:!0})})})]})]})]})})}))("AddressFields");var ee=s(1606),ie=s(3881),se=s(6957),re=s(5180),ne=s(1504),te=s(9016);const oe=(0,Y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 16 16",fill:"none",children:(0,Y.jsx)("path",{d:"M14 0C15.1046 0 16 0.895431 16 2V14C16 15.1046 15.1046 16 14 16H2C0.895431 16 0 15.1046 0 14V2C0 0.895431 0.895431 0 2 0H14ZM2 1.5C1.72386 1.5 1.5 1.72386 1.5 2V14C1.5 14.2761 1.72386 14.5 2 14.5H14C14.2761 14.5 14.5 14.2761 14.5 14V2C14.5 1.72386 14.2761 1.5 14 1.5H2ZM8.75 12H7.25V10.5H8.75V12ZM8.75 9H7.25V4H8.75V9Z",fill:"#A77F30",transform:"translate(2, 2) scale(0.8)"})}),ae={info:"#A77F30",success:"#2E7D32",warning:"#A77F30",error:"#8C0B0B"},de={info:"#F0B8490A",success:"#E8F5E9",warning:"#F0B8490A",error:"#CC18180A"},le={info:"#0000001A",success:"#A5D6A7",warning:"#0000001A",error:"#0000001A"},ce=({type:e="info",title:i,children:s,className:r,marginBottom:n="8px",style:t,...o})=>{const a=function(e="info"){switch(e){case"info":return re.A;case"success":return ne.A;case"warning":return oe;case"error":return te.A;default:return null}}(e);return(0,Y.jsx)(B.A,{direction:"column",gap:2,style:{background:de[e],border:`1px solid ${le[e]}`,borderRadius:"var(--radius-l, 8px)",fontSize:"13px",marginBottom:n,padding:"16px",...null!=t?t:{}},...o,children:(0,Y.jsxs)(B.A,{direction:"row",justify:"flex-start",align:"flex-start",gap:2,children:[a&&(0,Y.jsx)(ee.A,{icon:a,size:24,fill:ae[e],style:{marginTop:"-3px",minWidth:"24px"}}),(0,Y.jsxs)(B.A,{direction:"column",gap:4,style:{lineHeight:1.4},children:[i?(0,Y.jsx)(g.A,{weight:500,children:i}):null,s]})]})})};var me=s(9682);const pe=K((({warnings:e,originalAddress:i,normalizedAddress:s,editAddress:r,confirmAddress:o,errors:a,nextDesign:d=!1})=>{const[l,c]=(0,t.useState)(s?"normalized":"original"),m=s?(0,n.__)("We have slightly modified the address entered. If correct, please use the suggested address to ensure accurate delivery.","woocommerce-shipping"):(0,n.__)("We were unable to verify the address entered. It may still be a valid address, but we cannot ensure accurate delivery to this address as entered. Please confirm if you would like to continue with the address as entered or return to edit the address.","woocommerce-shipping"),p=s?(0,n.__)("Use selected address","woocommerce-shipping"):(0,n.__)("Confirm unverified address","woocommerce-shipping");return d?(0,Y.jsxs)("div",{children:[(0,Y.jsx)(F.A,{marginBottom:4,children:(0,Y.jsxs)(B.A,{justify:"space-between",align:"flex-start",children:[(0,Y.jsx)(g.A,{as:"h2",size:20,weight:500,children:(0,n.__)("Confirm Address","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{icon:me.A,onClick:()=>r(),title:(0,n.__)("Close modal","woocommerce-shipping"),style:{padding:0,minWidth:"24px",height:"24px"}})]})}),(0,Y.jsxs)(F.A,{style:{minHeight:"448px"},paddingY:6,children:[a.general&&(0,Y.jsx)(V.A,{status:"error",isDismissible:!1,children:a.general}),(0,Y.jsxs)(F.A,{marginBottom:8,children:[(0,Y.jsx)(ce,{type:"error",children:(0,n.__)("We found a similar address, Please review the suggestion below, or proceed with your original address.","woocommerce-shipping")}),!!e&&e.length>0&&e.map((({code:e,message:i})=>(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(F.A,{marginBottom:2}),(0,Y.jsx)(ce,{type:"warning",children:(0,Y.jsx)(B.A,{align:"center",justify:"left",children:(0,Y.jsx)(g.A,{children:i})})},e)]})))]}),(0,Y.jsx)(j.De,{data:{selectedAddress:l},onChange:e=>c(e.selectedAddress),form:{layout:{type:"regular",labelPosition:"top"},fields:["selectedAddress"]},fields:[{id:"selectedAddress",type:"text",Edit:"radio",label:(0,n.__)("Choose an address","woocommerce-shipping"),elements:[{label:(0,n.__)("Keep my address","woocommerce-shipping"),value:"original",description:(0,N.pD)(i)},{label:(0,n.__)("Suggested address","woocommerce-shipping"),value:"normalized",description:s?(0,N.pD)(s):void 0}]}]})]}),(0,Y.jsx)(F.A,{marginBottom:4}),(0,Y.jsxs)(B.A,{justify:"flex-end",align:"center",as:"footer",children:[(0,Y.jsx)(y.Ay,{onClick:r,variant:"tertiary",children:(0,n.__)("Edit address","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{onClick:()=>o("normalized"===l),variant:"primary",children:p})]})]}):(0,Y.jsxs)("div",{children:[a.general&&(0,Y.jsx)(V.A,{status:"error",isDismissible:!1,children:a.general}),(0,Y.jsx)("p",{children:m}),!!e&&e.length>0&&e.map((({code:e,message:i})=>(0,Y.jsx)(V.A,{status:"warning",isDismissible:!1,children:(0,Y.jsxs)(B.A,{align:"center",justify:"left",children:[(0,Y.jsx)(ee.A,{icon:P.A,fill:"#f0b849",style:{minWidth:"20px",alignSelf:"center",justifyContent:"left"}}),(0,Y.jsx)(g.A,{children:i})]})},e))),(0,Y.jsxs)(ie.A,{onChange:c,value:l,justify:"space-between",gap:4,children:[(0,Y.jsxs)(B.A,{direction:"column",gap:2,children:[(0,Y.jsx)("strong",{children:(0,n.__)("What you entered","woocommerce-shipping")}),(0,Y.jsx)(se.A,{value:"original",label:(0,N.pD)(i)})]}),(0,Y.jsx)(B.A,{direction:"column",gap:2,children:s&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)("strong",{children:(0,n.__)("Suggested","woocommerce-shipping")}),(0,Y.jsx)(se.A,{value:"normalized",label:(0,N.pD)(s)})]})})]}),(0,Y.jsxs)(B.A,{justify:"flex-end",as:"footer",children:[(0,Y.jsx)(y.Ay,{onClick:r,variant:"tertiary",children:(0,n.__)("Edit address","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{onClick:()=>o("normalized"===l),variant:"primary",children:p})]})]})}))("AddressSuggestion");var he=s(9315),ue=s(2502),ge=s(3526);function xe({className:e,intent:i="default",children:s,hideIcon:r=!1,noEllipsis:n=!1,...t}){const o=function(e="default"){switch(e){case"info":return re.A;case"success":return ne.A;case"warning":case"warning-alt":return P.A;case"error":return te.A;default:return null}}(i),a=!r&&!!o;return(0,Y.jsxs)("span",{className:(0,ge.A)("components-badge",e,{[`is-${i}`]:i,"has-icon":a,"woocommerce-status-badge":"warning-alt"===i,"is-actionable":"warning-alt"===i}),...t,style:{userSelect:"none",flexShrink:n?0:1},children:[a&&(0,Y.jsx)(ee.A,{icon:o,size:16,fill:"currentColor",className:"components-badge__icon"}),(0,Y.jsx)("span",{className:"components-badge__content",children:s})]})}const _e=({isVerified:e,isFormChanged:i=!1,isFormValid:s=!0,errorMessage:r=(0,n.__)("Unverified address","woocommerce-shipping"),onClick:t,message:a=(0,n.__)("Address verified","woocommerce-shipping"),addressType:d,nextDesign:l=!1})=>{const c=(0,o.useSelect)((e=>e(he.Y).getIsAddressVerificationInProgress(d)),[d]);return e&&!i&&s&&!c?!l&&(0,Y.jsxs)("span",{className:"verification",children:[(0,Y.jsx)(ee.A,{icon:ue.A,size:16}),a]}):c?l?(0,Y.jsx)(xe,{intent:"info",hideIcon:!0,noEllipsis:!0,children:(0,n.__)("Validating…","woocommerce-shipping")}):(0,Y.jsxs)("span",{className:"verification in-progress",children:[(0,Y.jsx)(ee.A,{icon:ue.A,size:16}),(0,n.__)("Verifying address…","woocommerce-shipping")]}):l?(0,Y.jsx)(xe,{intent:"warning",hideIcon:!0,noEllipsis:!0,children:r}):(0,Y.jsx)("span",{className:"verification not-verified",children:t?(0,Y.jsx)(y.Ay,{variant:"link",icon:re.A,onClick:e=>t?.(e),title:r,children:r}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(ee.A,{icon:re.A,size:22}),r]})})};var Ae=s(5919),ye=s(1495),je=s(9334);function fe({data:e,field:i,onChange:s,hideLabelFromVision:r}){const n="address"===i.id?e.address1||e.address:e[i.id];return(0,Y.jsx)(je.Ay,{value:n,label:i.label,onChange:e=>{s({[i.id]:e})},placeholder:i.placeholder,hideLabelFromVision:r,__next40pxDefaultSize:!0})}function we({data:e,field:i,onChange:s,options:r,hideLabelFromVision:n}){const t=e[i.id];return(0,Y.jsx)(H.A,{value:t,options:r,label:i.label,hideLabelFromVision:n,onChange:e=>{s({[i.id]:e})},__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})}function be({data:e,field:i,onChange:s}){const r=e[i.id];return(0,Y.jsx)(M.A,{label:i.label,checked:r,onChange:e=>{s({[i.id]:e})}})}function ve({type:e,initialValue:i,onSubmit:s,onCancel:r,isUpdating:o,isVerified:a,validationErrors:d,showUPSDAPTOSWarning:l,validateAddressSection:c,isSubmitButtonDisabled:m,originCountry:p}){const[h,u]=(0,t.useState)(i),[x,_]=(0,t.useState)(!1),[A,f]=(0,t.useState)({}),w={...d,...A},b=0===Object.keys(w).length,v=(0,t.useMemo)((()=>(0,N.zb)(e,h.country)),[e,h.country]),C=(0,t.useMemo)((()=>h.country?(0,N.Y5)(h.country):[]),[h.country]),S=(0,t.useMemo)((()=>(0,N.eI)({type:e,originCountry:p,destinationCountry:h.country})),[e,p,h.country]),k=(0,t.useMemo)((()=>[{id:"name",type:"text",label:e===X.Ld.DESTINATION?(0,n.__)("Recipient Name","woocommerce-shipping"):(0,n.__)("Name","woocommerce-shipping")},{id:"company",type:"text",label:(0,n.__)("Company","woocommerce-shipping"),isVisible:()=>e===X.Ld.ORIGIN},{id:"address",type:"text",placeholder:(0,n.__)("Address","woocommerce-shipping"),label:e===X.Ld.DESTINATION?(0,n.__)("Shipping Address","woocommerce-shipping"):(0,n.__)("Address","woocommerce-shipping")},{id:"address2",type:"text",placeholder:(0,n.__)("Apartment, suite, etc.","woocommerce-shipping"),isVisible:()=>e===X.Ld.DESTINATION,Edit:e=>(0,Y.jsx)(fe,{...e,hideLabelFromVision:!0})},{id:"city",type:"text",placeholder:(0,n.__)("City","woocommerce-shipping"),Edit:e=>(0,Y.jsx)(fe,{...e,hideLabelFromVision:!0})},{id:"state",type:"text",label:(0,n.__)("State","woocommerce-shipping"),placeholder:(0,n.__)("State","woocommerce-shipping"),Edit:e=>C.length>0?(0,Y.jsx)(we,{...e,options:C,hideLabelFromVision:!0}):(0,Y.jsx)(fe,{...e,hideLabelFromVision:!0})},{id:"postcode",type:"text",placeholder:(0,n.__)("Postal Code","woocommerce-shipping"),Edit:e=>(0,Y.jsx)(fe,{...e,hideLabelFromVision:!0})},{id:"country",type:"text",label:(0,n.__)("Country","woocommerce-shipping"),Edit:e=>(0,Y.jsx)(we,{...e,options:v,hideLabelFromVision:!0})},{id:"email",type:"text",label:S?(0,n.__)("Email","woocommerce-shipping"):(0,n.__)("Email (optional)","woocommerce-shipping"),Edit:e=>(0,Y.jsx)(fe,{...e})},{id:"phone",type:"text",label:(0,n.__)("Phone","woocommerce-shipping"),Edit:e=>(0,Y.jsx)(fe,{...e})},{id:"defaultAddress",type:"boolean",label:(0,n.__)("Save as default origin address","woocommerce-shipping"),isVisible:()=>e===X.Ld.ORIGIN,Edit:e=>(0,Y.jsx)(be,{...e})},{id:"defaultReturnAddress",type:"boolean",label:(0,n.__)("Save as default return address","woocommerce-shipping"),isVisible:()=>e===X.Ld.ORIGIN,Edit:e=>(0,Y.jsx)(be,{...e})}]),[v,C,S,e]),I={fields:["name","company",{id:"emailPhoneRow",layout:{type:"row"},children:["email","phone"]},"address","address2",{id:"cityStateRow",layout:{type:"row"},children:["city","state"]},{id:"postcodeCountryRow",layout:{type:"row"},children:["postcode","country"]},"defaultAddress","defaultReturnAddress"].filter(Boolean)},D=(0,t.useCallback)((e=>{u((i=>({...i,...e})))}),[u]);return(0,t.useEffect)((()=>{_(!E().isEqual(i,h));const e=c(h);f(e)}),[h,c]),(0,Y.jsxs)(Y.Fragment,{children:[l&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(ce,{type:"warning",children:(0,Y.jsx)(g.A,{children:(0,n.__)("You have accepted the UPS® Terms of Service for this address. If you update the address, the acceptance will be revoked, and you will need to accept the Terms of Service again before purchasing additional UPS® labels.","woocommerce-shipping")})}),(0,Y.jsx)(F.A,{marginBottom:3})]}),!a&&(0,Y.jsx)(F.A,{marginBottom:3,children:(0,Y.jsx)(ce,{type:"warning",children:(0,n.__)("This address hasn't been validated. We recommend validating to help ensure successful delivery.","woocommerce-shipping")})}),Object.keys(w).length>0&&(0,Y.jsx)(F.A,{marginBottom:3,children:(0,Y.jsxs)(ce,{type:"error",children:[(0,Y.jsx)(g.A,{children:(0,n.__)("Please fix the errors below to continue.","woocommerce-shipping")}),(0,Y.jsx)("ul",{style:{margin:0,paddingInlineStart:0,listStylePosition:"inside"},children:Object.keys(w).map((e=>(0,Y.jsx)("li",{children:w[e]},e)))})]})}),(0,Y.jsx)(q,{initialValue:{isUpdating:o,validationErrors:d},children:(0,Y.jsx)(F.A,{marginBottom:6,children:(0,Y.jsx)(j.De,{data:h,fields:k,onChange:D,form:I})})}),(0,Y.jsxs)(B.A,{justify:"flex-end",align:"center",as:"footer",children:[(0,Y.jsx)(y.Ay,{onClick:r,isBusy:o,variant:"tertiary",children:(0,n.__)("Cancel","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{onClick:async()=>{await s(h)},variant:"primary",disabled:m({isDirty:x,isValidForm:b}),isBusy:o,children:(0,n.__)("Validate and save","woocommerce-shipping")})]})]})}const Ce=K((({type:e,address:i,onCompleteCallback:s,onCancelCallback:r,isAdd:a=!1,orderId:d,originCountry:l,nextDesign:c=!1})=>{const[m,p]=(0,t.useState)(!1),[h,u]=(0,t.useState)(!1),[x,_]=(0,t.useState)(!1),[A,j]=(0,t.useState)(!1),[f,w]=(0,t.useState)((0,n.__)("Unvalidated address","woocommerce-shipping")),[b,v]=(0,t.useState)(!1),[C,S]=(0,t.useState)(null);if(e===X.Ld.DESTINATION&&!d)throw new Error("Order id is required for destination address");if(a&&e===X.Ld.DESTINATION)throw new Error("Destination address cannot be added");const E=i=>[{values:i,errors:(0,N.HI)(),type:e}].map((i=>(0,N.Rv)((0,N.eI)({type:e,originCountry:l,destinationCountry:i.values.country}))(i))).map(N.Lj).map(N.DT).map(N.jn).map(N.ib).map((i=>e===X.Ld.DESTINATION&&l?(0,N.lP)(l)(i):(0,N.FY)(i)))[0].errors,D=(0,o.useSelect)((i=>i(he.Y).getFormErrors(e)),[e]),L=(0,o.useSelect)((i=>i(he.Y).getSubmittedAddress(e)),[e]),R=(0,o.useSelect)((i=>i(he.Y).getIsAddressVerified(e)),[e]),H=(0,o.useSelect)((i=>i(he.Y).getNormalizedAddress(e)),[e]),M=(0,o.useSelect)((i=>i(he.Y).getAddressNeedsConfirmation(e)),[e]),W=(0,o.useSelect)((e=>e(he.Y).getAddressVerifcationWarnings(X.Ld.DESTINATION)),[]),U=async i=>{var s;u(!0),await(0,o.dispatch)(he.Y).normalizeAddress({address:{...i,address1:null!==(s=i.address)&&void 0!==s?s:"",address2:""}},e),u(!1)},$=e=>{var i;return{...e,address1:null!==(i=e.address)&&void 0!==i?i:"",address2:""}},G=async(i,s)=>{u(!0);try{a?await(0,o.dispatch)(he.Y).addOriginAddress($(i)):await(0,o.dispatch)(he.Y).updateShipmentAddress({orderId:null!=d?d:"",address:$(i),isVerified:s},e),j(!0)}finally{u(!1)}},Z=async e=>{S(e),v(!0)},J=()=>{v(!1),S(null)},K=()=>{p(!1),_(!1)};(0,t.useEffect)((()=>{M&&!x&&(_(!0),p(!0),(0,o.dispatch)(he.Y).resetAddressNormalizationResponse(e))}),[M,x,e]),(0,t.useEffect)((()=>{A&&(0,k.isEmpty)(D)&&s(i),(0,k.isEmpty)(D)||j(!1)}),[i,A,D,s]);const ee=({isDirty:e,isValidForm:i})=>!(!R||i&&e),ie=(0,o.useSelect)((s=>e!==X.Ld.DESTINATION&&s(ye.F).getUPSDAPCarrierStrategyForAddressId(i.id).hasAgreedToTos),[i.id,e]),se=!a&&ie;return(0,Y.jsxs)("div",{children:[c?(0,Y.jsx)(ve,{type:e,initialValue:{...i},onSubmit:U,onCancel:r,isUpdating:h,isVerified:R,validationErrors:D,showUPSDAPTOSWarning:se,validateAddressSection:E,isSubmitButtonDisabled:ee,originCountry:l,onSaveWithoutValidation:Z}):(0,Y.jsx)(O.Form,{validate:E,initialValues:i,onSubmit:async e=>{(0,Ae.Jq)(i,e)&&R?await G(e,!0):await U(e)},children:({isValidForm:s,handleSubmit:t,isDirty:o,values:a})=>(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsxs)(q,{initialValue:{isUpdating:h,validationErrors:D},children:[se&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(V.A,{status:"warning",isDismissible:!1,children:(0,Y.jsxs)(B.A,{align:"flex-start",children:[(0,Y.jsx)(z.A,{icon:P.A,style:{minWidth:"20px"}}),(0,Y.jsx)(g.A,{children:(0,n.__)("You have accepted the UPS® Terms of Service for this address. If you update the address, the acceptance will be revoked, and you will need to accept the Terms of Service again before purchasing additional UPS® labels.","woocommerce-shipping")})]})}),(0,Y.jsx)(F.A,{marginBottom:3})]}),(0,Y.jsx)("p",{children:(0,n.__)("Please complete all required fields and click the 'Validate and save' button below to confirm and validate your address details.","woocommerce-shipping")}),(0,Y.jsx)(Q,{group:e,errorCallback:w,originCountry:l})]}),(0,Y.jsxs)(B.A,{justify:"space-between",as:"footer",children:[(0,Y.jsx)(_e,{isVerified:R,isFormChanged:o&&!(0,Ae.Jq)(i,a),isFormValid:s,errorMessage:f,addressType:X.Ld.ORIGIN}),(0,Y.jsx)(T.A,{children:(0,Y.jsxs)(B.A,{gap:2,children:[(0,Y.jsx)(y.Ay,{onClick:r,isBusy:h,variant:"tertiary",children:(0,n.__)("Cancel","woocommerce-shipping")}),!(0,k.isEmpty)(D)&&!H&&(0,Y.jsx)(y.Ay,{onClick:()=>Z(a),isBusy:h,variant:"secondary",children:(0,n.__)("Save without validating","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{onClick:t,disabled:ee({isValidForm:s,isDirty:o}),isBusy:h,variant:"primary",children:(0,n.__)("Validate and save","woocommerce-shipping")})]})})]})]})}),m&&L&&H&&(0,Y.jsx)(I.A,{className:"address-suggestion-modal",onRequestClose:K,focusOnMount:!0,shouldCloseOnClickOutside:!1,title:(0,n.__)("Confirm address","woocommerce-shipping"),__experimentalHideHeader:c,size:c?"medium":void 0,children:(0,Y.jsx)(pe,{warnings:W,originalAddress:L,normalizedAddress:H,editAddress:K,confirmAddress:async i=>{p(!1),u(!0),H&&L&&(H.email=L.email,H.phone=L.phone,H.defaultAddress=L.defaultAddress,H.defaultReturnAddress=L.defaultReturnAddress);const s=i?H:L;s?(a?await(0,o.dispatch)(he.Y).addOriginAddress(s):await(0,o.dispatch)(he.Y).updateShipmentAddress({orderId:null!=d?d:"",address:s,isVerified:!0},e),u(!1),_(!1),j(!0)):console.warn(`No address to update for ${e}, address: ${s}`)},errors:D,nextDesign:c})}),b&&(0,Y.jsxs)(I.A,{title:(0,n.__)("Save without validation?","woocommerce-shipping"),onRequestClose:J,shouldCloseOnClickOutside:!1,children:[(0,Y.jsx)("p",{children:(0,n.__)("This address could not be validated. Proceeding without validation may result in delivery delays or failures.","woocommerce-shipping")}),(0,Y.jsxs)(B.A,{justify:"flex-end",gap:2,children:[(0,Y.jsx)(y.Ay,{variant:"tertiary",onClick:J,children:(0,n.__)("Cancel","woocommerce-shipping")}),(0,Y.jsx)(y.Ay,{variant:"primary",onClick:async()=>{C&&(v(!1),await G(C,!1),S(null))},children:(0,n.__)("Save anyway","woocommerce-shipping")})]})]})]})}))("AddressStep"),Se=({addressId:e,onClose:i,onComplete:s})=>{const r=(0,o.useSelect)((e=>e(he.Y).getOriginAddresses()),[]).find((i=>i.id===e)),t=!r;return(0,Y.jsx)(I.A,{size:"medium",onRequestClose:i,title:t?(0,n.__)("Add address","woocommerce-shipping"):(0,n.__)("Edit address","woocommerce-shipping"),children:(0,Y.jsx)(Ce,{type:"origin",address:(0,N.Tz)((0,N.nS)((0,N.fy)(null!=r?r:{}))),onCompleteCallback:s,onCancelCallback:i,isAdd:!r,nextDesign:!0})})},{useEntityRecordsWithPermissions:ke}=(0,v.Tl)(a.privateApis),Ee=()=>{const[e,i]=(0,t.useState)(!1),[s,r]=(0,t.useState)(),{deleteEntityRecord:v,invalidateResolution:S}=(0,o.useDispatch)(a.store),{createSuccessNotice:k,createErrorNotice:E}=(0,o.useDispatch)(d.store),{records:I,isResolving:N}=ke(C.kind,C.name),{canUser:D}=(0,o.useSelect)(a.store,[]),V=D("create",{kind:C.kind,name:C.name}),B=async()=>{i(!1),r(void 0)};return(0,Y.jsxs)(m.A,{children:[e&&(0,Y.jsx)(Se,{onClose:B,onComplete:async()=>{await B(),k(s?(0,n.__)("Address updated","woocommerce-shipping"):(0,n.__)("Address added","woocommerce-shipping"),{type:"snackbar"}),S("getEntityRecords",[C.kind,C.name,{}])},addressId:s}),(0,Y.jsx)(p.A,{isBorderless:!0,children:(0,Y.jsxs)(h.A,{children:[(0,Y.jsx)(u.A,{level:4,weight:"normal",children:(0,n.__)("Ship-from location","woocommerce-shipping")}),(0,Y.jsx)(g.A,{variant:"muted",children:(0,n.__)("This address is used to calculate shipping rates and delivery times.","woocommerce-shipping")})]})}),(0,Y.jsxs)(x.A,{children:[(0,Y.jsx)(j.Vw,{isLoading:N,data:I,getItemId:f,defaultLayouts:{list:{}},fields:[{id:"title",getValue:e=>(0,Y.jsxs)(_.A,{spacing:2,alignment:"left",children:[(0,Y.jsx)(g.A,{weight:500,children:w(e)}),e.item.default_address&&(0,Y.jsx)(xe,{children:(0,n.__)("Default Origin","woocommerce-shipping")}),e.item.default_return_address&&(0,Y.jsx)(xe,{children:(0,n.__)("Default Return","woocommerce-shipping")})]})},{id:"detail",getValue:b}],onChangeView:()=>null,paginationInfo:{totalItems:I.length,totalPages:1},actions:[{id:"edit",isPrimary:!0,icon:l.A,label:(0,n.__)("Edit","woocommerce-shipping"),isEligible:()=>!!V,callback:([e])=>{return s=e.id,r(s),void i(!0);var s}},{id:"delete",label:(0,n.__)("Delete","woocommerce-shipping"),isEligible:e=>!e.default_address&&!!V,callback:([e])=>(async e=>{try{await v(C.kind,C.name,e,{throwOnError:!0}),k((0,n.__)("Address deleted","woocommerce-shipping"),{type:"snackbar"})}catch{E((0,n.__)("Error deleting address","woocommerce-shipping"),{type:"snackbar"})}})(e.id)}],view:{fields:["detail"],type:"list",titleField:"title"},children:(0,Y.jsx)(j.Vw.Layout,{})}),(0,Y.jsx)(A.A,{isBorderless:!0,size:"small",children:(0,Y.jsx)(y.Ay,{variant:"tertiary",icon:c.A,disabled:!V,onClick:()=>{i(!0)},children:(0,n.__)("Add another","woocommerce-shipping")})})]})]})},Ie=()=>(0,Y.jsx)(r.A,{columns:1,gap:8,justify:"center",templateColumns:"660px",children:(0,Y.jsx)(Ee,{})})}};
//# sourceMappingURL=123.js.map?v=e7b2967d8fe20db4f864
//# debugId=310b535d-3138-5273-9308-d4dc2de44341
